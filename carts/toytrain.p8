pico-8 cartridge // http://www.pico-8.com
version 18
__lua__

left,right,up,down,fire1,fire2=0,1,2,3,4,5
black,dark_blue,dark_purple,dark_green,brown,dark_gray,light_gray,white,red,orange,yellow,green,blue,indigo,pink,peach=0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15

function _init()
   
	cls()
	switch = 0
	speed = 0
	-- Each segment (Sprite #, Start Coordinate X, Start Coordinate Y)
	train={{17,24,16},{18,24,24},{18,24,32},{18,24,40}}
end

function _draw()
	-- Draw Background and Tracks
	map(0,0,0,0,16,16)
	-- Draw Train
	draw_train(train)
	draw_switch()
end


function move_segment(segment)
	
	-- Top Side
	if (segment[3] == 8) then
		-- Top Right
		if (segment[2] + speed >= 96) then
			segment[3] += ((segment[2]+speed) - 96)
			segment[2] = 96
		else
			segment[2]+=speed
		end
	-- Right Side
	elseif (segment[2] == 96) then
		if (segment[3] + speed >= 112) then
			segment[2] -= 1+(segment[3]+speed) - 112
			segment[3] = 112
		else 
			segment[3]+=speed
		end
	-- Bottom Side
	elseif (segment[3] == 112) then
		if (segment[2] - speed <= 24) then
			segment[3] -= 24-(segment[2]-speed)
			segment[2] = 24
		else
			segment[2]-=speed
		end
	-- Left Side
	elseif (segment[2] == 24) then
		if (segment[3] - speed <= 8) then
			segment[2] += 8-(segment[3]-speed)+1
			segment[3]=8
		else
			segment[3]-=speed
		end
	end
end

function move_train()
	for s in all(train) do
		move_segment(s)
	end
end

function draw_switch()
  sspr(24+(16*switch),8,16,16,110,32)

end

function draw_train()
 for s in all(train) do 
	spr(s[1],s[2],s[3])
 end
end

function change_switch_state()
	if btnp(up) then
		if (switch == 0) then music(0) end
		switch += 1
		if (switch > 4) then	
			switch = 4
		end
	end
	if btnp(down) then
		switch -= 1
		if (switch <= 0) then
			switch=0
			music(-1)
		end
	end
	speed = switch
end

function _update()
	change_switch_state()	
	move_train()
end

__gfx__
000000005995594599455995555555555995594955555555555555553b3b3b3b0000000000000000000000000000000000000000000000000000000000000000
000000005495599594955995499499995949559459994999999999453bb3b3b30000000000000000000000000000000000000000000000000000000000000000
0070070059455495995599459449994959495599549994999949499533b333330000000000000000000000000000000000000000000000000000000000000000
00077000599559955555499555555555599995555949995555999945b3bb3bb30000000000000000000000000000000000000000000000000000000000000000
000770005495594555599995555555555944995554999555555599953333b3330000000000000000000000000000000000000000000000000000000000000000
00700700599559959994949599494999599999995999559999559995b3b333330000000000000000000000000000000000000000000000000000000000000000
000000005945549594999995944999495499949959955994949554953b33b3bb0000000000000000000000000000000000000000000000000000000000000000
00000000599559955555555555555555555555555495594999955995333b3b330000000000000000000000000000000000000000000000000000000000000000
00000000ccccccccccccccccb3b6666666666b3bb3b6666666666b3bb3b6666666666b3bb3b6666666666b3bb3b5555555555b3b000000000000000000000000
00000000c111111cc111111c3b36ffffffff63b33b36ffffffff63b33b36ffffffff63b33b36ffffffff63b33b355555555553b3000000000000000000000000
00000000c111111cc111111c3336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff6333000000000000000000000000
00000000c111111cc111111cbb36ffffffff6bb3bb36ffffffff6bb3bb36ffffffff6bb3bb35555555555bb3bb36ffffffff6bb3000000000000000000000000
00000000c11a811cc111111c3336ffffffff63333336ffffffff63333336ffffffff633333355555555553333336ffffffff6333000000000000000000000000
00000000c1a8a11cc111111c3336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff6333000000000000000000000000
00000000c18a481cc111111c3bb6ffffffff63bb3bb6ffffffff63bb3bb55555555553bb3bb6ffffffff63bb3bb6ffffffff63bb000000000000000000000000
00000000ccccccccccccccccb336ffffffff6b33b336ffffffff6b33b335555555555b33b336ffffffff6b33b336ffffffff6b33000000000000000000000000
000000000000000000000000b3b6ffffffff6b3bb3b6ffffffff6b3bb3b6ffffffff6b3bb3b6ffffffff6b3bb3b6ffffffff6b3b000000000000000000000000
0000000000000000000000003b36ffffffff63b33b36ffffffff63b33b36ffffffff63b33b36ffffffff63b33b36ffffffff63b3000000000000000000000000
0000000000000000000000003336ffffffff633333355555555553333336ffffffff63333336ffffffff63333336ffffffff6333000000000000000000000000
000000000000000000000000bb36ffffffff6bb3bb35555555555bb3bb36ffffffff6bb3bb36ffffffff6bb3bb36ffffffff6bb3000000000000000000000000
0000000000000000000000003336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff6333000000000000000000000000
0000000000000000000000003336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff63333336ffffffff6333000000000000000000000000
0000000000000000000000003bb55555555553bb3bb6ffffffff63bb3bb6ffffffff63bb3bb6ffffffff63bb3bb6ffffffff63bb000000000000000000000000
000000000000000000000000b335555555555b33b336666666666b33b336666666666b33b336666666666b33b336666666666b33000000000000000000000000
__map__
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070503030303030303030607070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070107070707070707070107070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070403030303030303030207070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
012000000277200000000000277202772027720277202772000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0110001f0000003612000000361200000036120000003612000000361200000036120000003612000000361200000036120000003612000000361200000036120000003612000000361200000036120000003612
__music__
03 00014344

